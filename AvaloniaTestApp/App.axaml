<Application xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  x:Class="AvaloniaTestApp.App"
  xmlns:local="using:AvaloniaTestApp"
  xmlns:vm="using:AvaloniaTestApp.ViewModels"
  RequestedThemeVariant="Default">

  <Application.Styles>
    <SimpleTheme />
    <StyleInclude Source="avares://Avalonia.Controls.DataGrid/Themes/Simple.xaml"/>
  </Application.Styles>

  <Application.Resources>
    <vm:StringToNullConverter x:Key="StringToNullConverter" />

    <!-- Make some adjustments to the data grid control themes for a better default visual appearance -->
    <ControlTheme x:Key="DataGridCellTextBoxTheme" BasedOn="{StaticResource {x:Type TextBox}}" TargetType="TextBox">
      <Setter Property="VerticalAlignment" Value="Stretch" />
    </ControlTheme>

    <ControlTheme x:Key="{x:Type CheckBox}" BasedOn="{StaticResource {x:Type CheckBox}}"  TargetType="CheckBox">
      <Setter Property="Background" Value="{DynamicResource ThemeBackgroundBrush}" />
    </ControlTheme>

    <ControlTheme x:Key="{x:Type DataGridCell}" TargetType="DataGridCell">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="HorizontalContentAlignment" Value="Stretch" />
      <Setter Property="VerticalContentAlignment" Value="Stretch" />
      <Setter Property="Template">
        <ControlTemplate>
          <Border x:Name="CellBorder" Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
            CornerRadius="{TemplateBinding CornerRadius}">
            <Grid ColumnDefinitions="*,Auto">
              <ContentPresenter Margin="{TemplateBinding Padding}"
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"
                Foreground="{TemplateBinding Foreground}" />

              <Rectangle Name="PART_RightGridLine" Grid.Column="1" Width="0.1" VerticalAlignment="Stretch" />
            </Grid>
          </Border>
        </ControlTemplate>
      </Setter>
    </ControlTheme>

    <ControlTheme x:Key="{x:Type DataGridRow}" TargetType="DataGridRow">
      <Setter Property="Background" Value="{Binding $parent[DataGrid].RowBackground}" />
      <Setter Property="Template">
        <ControlTemplate>
          <Border x:Name="RowBorder" Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
            CornerRadius="{TemplateBinding CornerRadius}">
            <DataGridFrozenGrid Name="PART_Root" ColumnDefinitions="Auto,*" RowDefinitions="*,Auto,Auto">
              <Rectangle Name="BackgroundRectangle" Grid.RowSpan="2" Grid.ColumnSpan="2" />
              <DataGridRowHeader Name="PART_RowHeader" Grid.RowSpan="3" DataGridFrozenGrid.IsFrozen="True" />
              <DataGridCellsPresenter Name="PART_CellsPresenter" Grid.Column="1" DataGridFrozenGrid.IsFrozen="True" />
              <DataGridDetailsPresenter Name="PART_DetailsPresenter" Grid.Row="1" Grid.Column="1" />
              <Rectangle Name="PART_BottomGridLine" Grid.Row="2" Grid.Column="1" Height="0.1" HorizontalAlignment="Stretch" />
            </DataGridFrozenGrid>
          </Border>
        </ControlTemplate>
      </Setter>

      <Style Selector="^ /template/ Rectangle#BackgroundRectangle">
        <Setter Property="IsVisible" Value="False" />
        <Setter Property="Fill" Value="{DynamicResource HighlightBrush2}" />
      </Style>

      <Style Selector="^:pointerover /template/ Rectangle#BackgroundRectangle">
        <Setter Property="IsVisible" Value="True" />
        <Setter Property="Opacity" Value="0.5" />
      </Style>

      <Style Selector="^:selected /template/ Rectangle#BackgroundRectangle">
        <Setter Property="IsVisible" Value="True" />
        <Setter Property="Opacity" Value="1" />
      </Style>

      <Style Selector="^:selected">
        <Setter Property="Foreground" Value="{DynamicResource HighlightForegroundBrush}" />
      </Style>
    </ControlTheme>

    <ControlTheme x:Key="{x:Type DataGrid}" TargetType="DataGrid">
      <Setter Property="RowBackground" Value="{DynamicResource ThemeBackgroundBrush}" />
      <Setter Property="Background" Value="{DynamicResource ThemeBackgroundBrush}" />
      <Setter Property="HeadersVisibility" Value="Column" />
      <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
      <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
      <Setter Property="SelectionMode" Value="Extended" />
      <Setter Property="HorizontalGridLinesBrush" Value="{DynamicResource ThemeBorderHighColor}" />
      <Setter Property="VerticalGridLinesBrush" Value="{DynamicResource ThemeBorderHighColor}" />
      <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderLowColor}" />
      <Setter Property="BorderThickness" Value="{DynamicResource ThemeBorderThickness}" />
      <Setter Property="DropLocationIndicatorTemplate">
        <Template>
          <Rectangle Width="2" Fill="{DynamicResource ThemeBorderHighColor}" />
        </Template>
      </Setter>
      <Setter Property="Template">
        <ControlTemplate>
          <Border x:Name="DataGridBorder" Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
            CornerRadius="{TemplateBinding CornerRadius}">
            <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,*,Auto,Auto" ClipToBounds="True">
              <DataGridColumnHeader Name="PART_TopLeftCornerHeader" Width="22" />
              <DataGridColumnHeadersPresenter Name="PART_ColumnHeadersPresenter" Grid.Column="1" />
              <DataGridColumnHeader Name="PART_TopRightCornerHeader" Grid.Column="2" />
              <Rectangle Name="PART_ColumnHeadersAndRowsSeparator" Grid.ColumnSpan="3"
                Height="1" VerticalAlignment="Bottom" Fill="{DynamicResource ThemeControlMidHighBrush}"
                StrokeThickness="1" />

              <DataGridRowsPresenter Name="PART_RowsPresenter" Grid.Row="1" Grid.ColumnSpan="2"
                ScrollViewer.IsScrollInertiaEnabled="{TemplateBinding IsScrollInertiaEnabled}">
                <DataGridRowsPresenter.GestureRecognizers>
                  <ScrollGestureRecognizer CanHorizontallyScroll="True" CanVerticallyScroll="True"
                    IsScrollInertiaEnabled="{Binding (ScrollViewer.IsScrollInertiaEnabled), ElementName=PART_RowsPresenter}" />
                </DataGridRowsPresenter.GestureRecognizers>
              </DataGridRowsPresenter>
              <Rectangle Name="PART_BottomRightCorner" Grid.Row="2" Grid.Column="2"
                Fill="{DynamicResource ThemeControlMidHighBrush}" />
              <Rectangle Name="BottomLeftCorner" Grid.Row="2" Grid.ColumnSpan="2"
                Fill="{DynamicResource ThemeControlMidHighBrush}" />
              <ScrollBar Name="PART_VerticalScrollbar" Grid.Row="1" Grid.Column="2"
                Width="{DynamicResource ScrollBarThickness}" Orientation="Vertical" />

              <Grid Grid.Row="2" Grid.Column="1" ColumnDefinitions="Auto,*">
                <Rectangle Name="PART_FrozenColumnScrollBarSpacer" />
                <ScrollBar Name="PART_HorizontalScrollbar" Grid.Column="1"
                  Height="{DynamicResource ScrollBarThickness}" Orientation="Horizontal" />
              </Grid>
            </Grid>
          </Border>
        </ControlTemplate>
      </Setter>
    </ControlTheme>
  </Application.Resources>
</Application>
